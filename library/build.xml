<project name="ull" default="all" basedir=".">

	<!--
		REMARK:
		To build javadoc and test, please execute ant -Dclasspath=$CLASSPATH.
		For target test, junit.jar has to be included in the classpath
	-->

	<!-- set global properties for this build -->
	<property name="project" value="ull" />
	<property name="src" value="src" />
	<property name="build" value="build" />
	<property name="dist"  value="dist" />
	<property name="docs" value="docs" />
	<property name="javadoc" value="javadoc" />


	<!-- Builds the library and creates ${dist}/${project}.jar -->
	<target name="library">
		<!-- Create the ${docs} directory -->
		<mkdir dir="${docs}" />
		<!-- Create the build directory -->
		<mkdir dir="${build}" />
		<!-- copy versiondoc.txt -->
		<copy file="${docs}/versiondoc.txt" todir="${build}" />
		<!-- Compile the java code from ${src} into ${build} -->
		<javac srcdir="${src}" destdir="${build}" debug="on">
			<classpath>
				<pathelement path="jython.jar" />
				<pathelement path="${classpath}" />
				<pathelement location="${build}" />
			</classpath>
		</javac>
		<!-- Create the ${dist}/lib directory -->
		<mkdir dir="${dist}" />
		<!-- Put everything in ${build} into the ${project}.jar file -->
		<jar jarfile="${dist}/${project}.jar" basedir="${build}" excludes="**/test/**" />
	</target>

	<!-- Tests the library with junit -->
	<target name="test" depends="clean, library">
		<java classname="junit.textui.TestRunner" failonerror="on" fork="on">
			<arg value="com.livinglogic.tree.test.AllTests"/>
			<classpath>
				<pathelement path="${classpath}" />
				<pathelement location="${build}" />
			</classpath>
		</java>
		<!--
		<junit printsummary="yes" fork="no" haltonfailure="no">
			<formatter type="plain" usefile="no" />
			<test name="com.livinglogic.tree.test.AllTests" todir="${build}" />
			<classpath>
				<pathelement location="${build}" />
			</classpath>
		</junit>
		-->
	</target>

	<!-- Creates javadoc -->
	<target name="javadoc">
		<mkdir dir="${javadoc}" />
		<javadoc
			sourcepath="${src}"
			packagenames="com.*"
			destdir="${javadoc}"
			author="true"
			version="true">
			<classpath>
				<pathelement path="${classpath}" />
				<pathelement location="$/usr/local/lib/java/junit.jar" />
			</classpath>
		</javadoc>
	</target>

	<target name="all" depends="clean, test, javadoc"  />

	<target name="clean">
		<!-- Delete all the directories -->
		<delete dir="${build}" />
		<delete dir="${dist}" />
		<delete dir="${javadoc}" />
	</target>
</project>



